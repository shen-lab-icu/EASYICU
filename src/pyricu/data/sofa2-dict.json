{
  "sofa2": {
    "concepts": [
      "sofa2_resp",
      "sofa2_coag",
      "sofa2_liver",
      "sofa2_cardio",
      "sofa2_cns",
      "sofa2_renal"
    ],
    "description": "SOFA-2 (2025) aggregate score",
    "category": "outcome",
    "callback": "sofa2_score",
    "class": "rec_cncpt"
  },
  "sofa2_resp": {
    "concepts": [
      "pafi",
      "spo2",
      "fio2",
      "adv_resp",
      "ecmo",
      "ecmo_indication"
    ],
    "description": "SOFA-2 respiratory component (P/F≤300/225/150/75 with advanced support; ECMO auto-4 if respiratory indication)",
    "category": "outcome",
    "callback": "sofa2_resp",
    "class": "rec_cncpt"
  },
  "sofa2_coag": {
    "concepts": "plt",
    "description": "SOFA-2 hemostasis component (updated thresholds: ≤150/100/80/50)",
    "category": "outcome",
    "callback": "sofa2_coag",
    "class": "rec_cncpt",
    "aggregate": "min"
  },
  "sofa2_liver": {
    "concepts": "bili",
    "description": "SOFA-2 liver component (relaxed 1pt threshold: ≤3.0 mg/dL vs ≤1.9 in SOFA-1)",
    "category": "outcome",
    "aggregate": "max",
    "callback": "sofa2_liver",
    "class": "rec_cncpt"
  },
  "sofa2_cardio": {
    "concepts": [
      "map",
      "norepi60",
      "epi60",
      "dopa60",
      "dobu60",
      "other_vaso",
      "mech_circ_support"
    ],
    "description": "SOFA-2 cardiovascular component (combined norepi+epi: ≤0.2/0.2-0.4/>0.4 μg/kg/min; dopamine backup only; mechanical support)",
    "category": "outcome",
    "aggregate": [
      "min",
      "max",
      "max",
      "max",
      "max",
      null,
      null
    ],
    "callback": "sofa2_cardio",
    "class": "rec_cncpt"
  },
  "sofa2_cns": {
    "concepts": [
      "gcs",
      "delirium_tx",
      "sedated_gcs"
    ],
    "description": "SOFA-2 brain component (GCS 15/13-14/9-12/6-8/3-5; delirium treatment → 1pt even if GCS=15)",
    "category": "outcome",
    "callback": "sofa2_cns",
    "class": "rec_cncpt"
  },
  "sofa2_renal": {
    "concepts": [
      "crea",
      "rrt",
      "rrt_criteria",
      "urine_mlkgph",
      "potassium",
      "ph",
      "bicarb"
    ],
    "description": "SOFA-2 renal component (RRT→4pt; meets RRT criteria→4pt; urine <0.5/<0.3 mL/kg/h; crea >1.2/2.0/3.5 mg/dL)",
    "category": "outcome",
    "aggregate": [
      "max",
      null,
      null,
      null,
      "max",
      "min",
      "min"
    ],
    "callback": "sofa2_renal",
    "class": "rec_cncpt"
  },
  "adv_resp": {
    "class": "lgl_cncpt",
    "description": "Advanced respiratory support (IMV/NIV/HFNC/CPAP/BiPAP)",
    "category": "respiratory",
    "sources": {
      "miiv": [
        {
          "table": "chartevents",
          "sub_var": "itemid",
          "ids": [
            223848,
            223849,
            225411
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "respiratorycare",
          "sub_var": "ventstartoffset",
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "respiratorycharting",
          "sub_var": "respchartvaluelabel",
          "regex": "CPAP|BiPAP|NIV|PEEP/CPAP|Bipap",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "listitems",
          "sub_var": "item",
          "regex": "(CPAP|Bipap|NIV|IPPV|SIMV|ASB|MMV|BIPAP)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "listitems",
          "sub_var": "itemid",
          "ids": [
            6685,
            6694
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [
            3845,
            15001552
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ]
    }
  },
  "ecmo": {
    "class": "lgl_cncpt",
    "description": "Extracorporeal membrane oxygenation in use",
    "category": "respiratory",
    "sources": {
      "miiv": [
        {
          "table": "chartevents",
          "sub_var": "itemid",
          "ids": [
            224660,
            228193
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "treatment",
          "sub_var": "treatmentstring",
          "regex": "ECMO",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "procedureorderitems",
          "sub_var": "item",
          "regex": "ECMO",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": []
    }
  },
  "ecmo_indication": {
    "class": "chr_cncpt",
    "description": "ECMO indication (respiratory/cardiovascular)",
    "category": "respiratory",
    "sources": {
      "miiv": [
        {
          "table": "chartevents",
          "sub_var": "itemid",
          "ids": [
            224660,
            228193
          ],
          "callback": "transform_fun(set_val('respiratory'))"
        }
      ],
      "eicu": [
        {
          "table": "treatment",
          "sub_var": "treatmentstring",
          "regex": "VV.*ECMO|ECMO.*respiratory",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val('respiratory'))"
        },
        {
          "table": "treatment",
          "sub_var": "treatmentstring",
          "regex": "VA.*ECMO|ECMO.*cardio",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val('cardiovascular'))"
        }
      ],
      "aumc": [
        {
          "table": "procedureorderitems",
          "sub_var": "item",
          "regex": "VV.*ECMO",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val('respiratory'))"
        },
        {
          "table": "procedureorderitems",
          "sub_var": "item",
          "regex": "VA.*ECMO",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val('cardiovascular'))"
        }
      ],
      "hirid": []
    }
  },
  "sedated_gcs": {
    "class": "num_cncpt",
    "description": "GCS before sedation (for sedated patients)",
    "category": "neurology",
    "unit": "score",
    "min": 3,
    "max": 15,
    "sources": {
      "miiv": [
        {
          "table": "chartevents",
          "sub_var": "itemid",
          "ids": [
            220739
          ]
        }
      ],
      "eicu": [
        {
          "table": "nursecharting",
          "sub_var": "nursingchartcelltypevallabel",
          "regex": "GCS.*prior.*sedation",
          "class": "rgx_itm"
        }
      ],
      "aumc": [
        {
          "table": "numericitems",
          "sub_var": "item",
          "regex": "GCS.*pre.*sedat",
          "class": "rgx_itm"
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": []
        }
      ]
    }
  },
  "urine_mlkgph": {
    "concepts": "urine",
    "class": "rec_cncpt",
    "description": "Urine output rate (mL/kg/h)",
    "category": "renal",
    "unit": "mL/kg/h",
    "callback": "urine_mlkgph"
  },
  "mech_circ_support": {
    "class": "lgl_cncpt",
    "description": "Mechanical circulatory support (IABP/LVAD/Impella)",
    "category": "cardiovascular",
    "sources": {
      "miiv": [
        {
          "table": "chartevents",
          "sub_var": "itemid",
          "ids": [
            224272,
            224322,
            225979,
            220128
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "treatment",
          "sub_var": "treatmentstring",
          "regex": "IABP|balloon pump|LVAD|Impella",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "procedureorderitems",
          "sub_var": "item",
          "regex": "(IABP|balloon|Impella|LVAD)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "listitems",
          "sub_var": "itemid",
          "ids": [
            6658
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ]
    }
  },
  "other_vaso": {
    "class": "lgl_cncpt",
    "description": "Other vasoactive medication present (vasopressin/phenylephrine/milrinone)",
    "category": "cardiovascular",
    "sources": {
      "miiv": [
        {
          "table": "inputevents",
          "sub_var": "itemid",
          "ids": [
            222315,
            221749,
            221986
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "medication",
          "sub_var": "drugname",
          "regex": "vasopressin|phenylephrine|milrinone",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "infusiondrug",
          "sub_var": "drugname",
          "regex": "vasopressin|phenylephrine|milrinone",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "drugitems",
          "sub_var": "item",
          "regex": "(Noradrenaline|Adrenaline|Fenylefrine|vasopressin|Milrinone)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": [
        {
          "table": "pharma",
          "sub_var": "pharmacode",
          "ids": [
            112,
            113,
            115,
            116,
            426
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ]
    }
  },
  "delirium_tx": {
    "class": "lgl_cncpt",
    "description": "Delirium treatment administered (e.g., haloperidol, quetiapine)",
    "category": "neurology",
    "sources": {
      "miiv": [
        {
          "table": "inputevents",
          "sub_var": "itemid",
          "ids": [
            221824
          ],
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "prescriptions",
          "sub_var": "drug",
          "regex": "haloperidol|quetiapine|olanzapine|risperidone",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "medication",
          "sub_var": "drugname",
          "regex": "haloperidol|quetiapine|olanzapine|risperidone",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "drugitems",
          "sub_var": "item",
          "regex": "(haloperidol|quetiapine|olanzapine|risperidone)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": [
        {
          "table": "pharma",
          "sub_var": "pharmaid",
          "regex": "(haloperidol|quetiapine|olanzapine|risperidone)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ]
    }
  },
  "rrt": {
    "class": "lgl_cncpt",
    "description": "Renal replacement therapy in use",
    "category": "renal",
    "sources": {
      "miiv": [
        {
          "table": "procedureevents",
          "sub_var": "itemid",
          "ids": [225441, 225802, 225803, 225809, 225955],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "eicu": [
        {
          "table": "treatment",
          "sub_var": "treatmentstring",
          "regex": "(CRRT|hemodialysis|dialysis)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "aumc": [
        {
          "table": "procedureorderitems",
          "sub_var": "item",
          "regex": "(CRRT|Hemodialysis|Dialysis|CVVH)",
          "class": "rgx_itm",
          "callback": "transform_fun(set_val(TRUE))"
        },
        {
          "table": "numericitems",
          "sub_var": "itemid",
          "ids": [
            6684
          ],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [],
          "callback": "transform_fun(set_val(TRUE))"
        }
      ]
    }
  },
  "rrt_criteria": {
    "class": "lgl_cncpt",
    "description": "Meets criteria for RRT but not receiving it (crea>1.2 mg/dL or oliguria>6h PLUS K+≥6.0 OR acidosis pH≤7.20+HCO3≤12)",
    "category": "renal",
    "sources": {
      "miiv": [],
      "eicu": [],
      "aumc": [],
      "hirid": []
    },
    "target": "id_tbl",
    "callback": "rrt_criteria"
  },
  "potassium": {
    "class": "num_cncpt",
    "description": "Serum potassium",
    "category": "chemistry",
    "unit": "mmol/L",
    "min": 2.0,
    "max": 10.0,
    "sources": {
      "miiv": [
        {
          "table": "labevents",
          "sub_var": "itemid",
          "ids": [
            50822,
            50971
          ]
        }
      ],
      "eicu": [
        {
          "table": "lab",
          "sub_var": "labname",
          "regex": "potassium",
          "class": "rgx_itm"
        }
      ],
      "aumc": [
        {
          "table": "numericitems",
          "sub_var": "itemid",
          "ids": [
            6835,
            9555
          ]
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [
            24000524
          ]
        }
      ]
    }
  },
  "ph": {
    "class": "num_cncpt",
    "description": "Arterial pH",
    "category": "blood_gas",
    "unit": "pH",
    "min": 6.5,
    "max": 8.0,
    "sources": {
      "miiv": [
        {
          "table": "labevents",
          "sub_var": "itemid",
          "ids": [
            50820
          ]
        }
      ],
      "eicu": [
        {
          "table": "lab",
          "sub_var": "labname",
          "regex": "pH",
          "class": "rgx_itm"
        }
      ],
      "aumc": [
        {
          "table": "numericitems",
          "sub_var": "itemid",
          "ids": [
            6848,
            12310
          ]
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [
            20000200
          ]
        }
      ]
    }
  },
  "bicarb": {
    "class": "num_cncpt",
    "description": "Serum bicarbonate (HCO3)",
    "category": "chemistry",
    "unit": "mmol/L",
    "min": 5.0,
    "max": 50.0,
    "sources": {
      "miiv": [
        {
          "table": "labevents",
          "sub_var": "itemid",
          "ids": [
            50882
          ]
        }
      ],
      "eicu": [
        {
          "table": "lab",
          "sub_var": "labname",
          "regex": "bicarbonate|HCO3",
          "class": "rgx_itm"
        }
      ],
      "aumc": [
        {
          "table": "numericitems",
          "sub_var": "itemid",
          "ids": [
            6850,
            9990
          ]
        }
      ],
      "hirid": [
        {
          "table": "observations",
          "sub_var": "variableid",
          "ids": [
            24000500
          ]
        }
      ]
    }
  }
}